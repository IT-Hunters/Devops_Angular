<h2>Tache List</h2>

<!-- Add/Edit Tache Form -->
<div>
  <h3>{{ editingTache ? 'Edit Tache' : 'Add New Tache' }}</h3>
  <form (ngSubmit)="editingTache ? updateTache() : addTache()">
    <div>
      <label>Date:</label>
      <input type="date" [(ngModel)]="editingTache ? editingTache.dateTache : newTache.dateTache" name="dateTache" required>
    </div>
    <div>
      <label>Duration (hours):</label>
      <input type="number" [(ngModel)]="editingTache ? editingTache.duree : newTache.duree" name="duree" required>
    </div>
    <div>
      <label>Hourly Rate:</label>
      <input type="number" [(ngModel)]="editingTache ? editingTache.tarifHoraire : newTache.tarifHoraire" name="tarifHoraire" required>
    </div>
    <div>
      <label>Type:</label>
      <select [(ngModel)]="editingTache ? editingTache.typeTache : newTache.typeTache" name="typeTache" required>
        <option value="MENAGERE">Menagere</option>
        <option value="JARDINAGE">Jardinage</option>
        <option value="BRICOLAGE">Bricolage</option>
      </select>
    </div>
    <button type="submit">{{ editingTache ? 'Update' : 'Add' }}</button>
    <button type="button" *ngIf="editingTache" (click)="editingTache = null">Cancel</button>
  </form>
</div>

<!-- Tache List Table -->
<table>
  <thead>
    <tr>
      <th>Select</th>
      <th>ID</th>
      <th>Date</th>
      <th>Duration</th>
      <th>Hourly Rate</th>
      <th>Type</th>
      <th>Final Tariff</th>
      <th>Assigned Etudiant</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let tache of taches">
      <td><input type="checkbox" (change)="toggleTaskSelection(tache)" [checked]="tasksToAssign.includes(tache)"></td>
      <td>{{ tache.idTache }}</td>
      <td>{{ tache.dateTache }}</td>
      <td>{{ tache.duree }}</td>
      <td>{{ tache.tarifHoraire }}</td>
      <td>{{ tache.typeTache }}</td>
      <td>{{ tache.tarifFinal }}</td>
      <td>{{ tache.etudiantOrdinaire ? tache.etudiantOrdinaire.nomEt + ' ' + tache.etudiantOrdinaire.prenomEt : 'Not Assigned' }}</td>
      <td>
        <button (click)="editTache(tache)">Edit</button>
        <button (click)="deleteTache(tache.idTache)">Delete</button>
      </td>
    </tr>
  </tbody>
</table>

<!-- Assign Tasks to Etudiant Form -->
<div>
  <h3>Assign Tasks to Etudiant</h3>
  <form (ngSubmit)="addTasksAndAffectToEtudiant()">
    <div>
      <label>Nom Etudiant:</label>
      <input type="text" [(ngModel)]="nomEt" name="nomEt" required>
    </div>
    <div>
      <label>Prenom Etudiant:</label>
      <input type="text" [(ngModel)]="prenomEt" name="prenomEt" required>
    </div>
    <button type="submit" [disabled]="tasksToAssign.length === 0">Assign Selected Tasks</button>
  </form>
</div>